{% extends "b2note_app/__base.html" %}

{% block content %}

    <h3>Search</h3>

    <form action="/search" method="post">

        {% csrf_token %}

        {% for f in form %}

            {% if f.logicals %}

                <select name="logical{{forloop.counter0}}" onchange="this.form.submit()">

                    {% for op in f.logicals %}

                        {% if op == f.logical %}

                            <option value="{{op}}" selected>{{ op }}</option>

                        {% else %}

                             <option value="{{op}}">{{ op }}</option>

                        {% endif %}

                    {% endfor %}

                </select>

            {% endif %}

            {% if f.types %}

                <select name="select{{forloop.counter0}}" onchange="this.form.submit()">

                    {% for op in f.types %}

                        {% if op == f.type %}

                            <option value="{{op}}" selected>{{ op }}</option>

                        {% else %}

                            <option value="{{op}}">{{ op }}</option>

                        {% endif %}

                    {% endfor %}

                </select>

                {% if f.type %}

                    {% if f.type == "Semantic tag" %}

                        <div id="select_semantic">

                            <input type="hidden" name="ontology_json{{forloop.counter0}}" id="ontology_json{{forloop.counter0}}" {% if f.search_json %}value="{{f.search_json}}"{% endif %}>
                            <input type="text" class="form-control" name="q{{forloop.counter0}}" id="id_q{{forloop.counter0}}" value="{% if query %}{{ query }}{% elif f.search_param %}{{f.search_param.labels}} ({{f.search_param.short_form}}){% endif %}" placeholder="Type-in to select a tag"  autocomplete="off" spellcheck="false" dir="auto" autofocus/>

                            <br>
                            <input type="checkbox" name="cbox{{forloop.counter0}}" id="cbox{{forloop.counter0}}" value="syn" {% if f.syn_incl %}checked{% endif %}>Include synonym matches

                        </div>

                    {% elif f.type == "Free-text keyword" %}

                        <input type="text" name="keyword{{forloop.counter0}}" {% if f.search_param %}value="{{f.search_param}}"{% endif %} id="keyword{{forloop.counter0}}" placeholder="Type-in a free-text keyword"/>

                    {% elif f.type == "Comment" %}

                        <p>Return all files with comment annotations (combines with the other search parameters).</p>

                    {% endif %}

                {% endif %}

            {% endif %}

            <br>

        {% endfor %}

        {% if fmessage %}<p>{{fmessage}}</p>{% endif %}

        <br>
        <input type="submit" name="plus" value="+"/>

        <br>
        <button type="submit" class="btn btn-default" name="launch_search" title="Search for files">
            <span class="glyphicon glyphicon-search"></span>
        </button>

    </form>

    <br>
    <br>
    <br>

{% endblock %}